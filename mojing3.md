# “问题相似度计算”问题初探

本博客记录了对“问题相似度计算”这个问题的初步探索尝试，分享了自己参加比赛：[拍拍贷——第三届魔镜杯大赛](https://www.ppdai.ai/mirror/goToMirrorDetail?mirrorId=1)的经历和一些心得，介绍了**基于规则**和**基于深度学习**两个角度的方法，希望对读者能有所启发。这个比赛参赛的选手很多，牛人也很多，笔者最终只取得了34名的成绩，刚刚进入前10%(共有350多只队伍提交了结果)。

## 背景
“问题相似度计算”这个问题，顾名思义，就是判断两个问题是否表达相同的含义，是NLP领域很重要的一个任务(虽然很重要，但是我之前从来没有实际接触过，囧)。早期在问答(QA)任务，特别是社区问答(CQA，比如百度知道、知乎等)中，这个任务非常重要，由于自然语言的灵活性，不同的人对于相同的问题可能使用不同的表述方式，那么对于某个用户提出的问题，可以使用“问题相似度计算”技术，和所有的已有问题进行计算，如果已有问题中存在某个问题和用户提出的问题意思是一样的，那么那个已有问题的答案就是用户需要的答案。

近年来，我们国家的服务业在不断发展，客服成了我们日常生活中经常打交道的对象，在客服场景中，“问题相似度计算”这个技术也是非常核心的技术，一方面这个技术是实现智能客服的基础，另一方面，这个技术也可以帮助人工客服实现用户问题和标准问题库中相似问题的快速匹配，从而为客户提供更好的服务。而我这次参加的比赛，就是在金融客服领域的“问题相似度计算”任务。 事实上，在魔镜杯大赛进行的同时，阿里也发布了一个[“金融大脑-金融智能NLP服务”比赛](https://dc.cloud.alipay.com/index#/topic/intro?id=3)，其任务也是“问题相似度计算”， 从这里也可以看出这个任务在实际商业场景中的重要性。

下面，我们就简单介绍一下魔镜杯比赛的基本情况。

## 任务

### 任务定义
魔镜杯比赛的任务非常明确，就是给定一个句子q1和另一个句子q2，系统自动判断这两个句子的含义是相同(label=1)还是不同(label=0)。

### 数据集

为了让选手可以训练问题相似度计算模型，魔镜杯发布了包含25万多个训练样本的训练集，每个训练样本由(label, q1, q2)组成。训练样本中的正例(label=1，也就是说两个句子含义相同) 和负例(label=0，两个句子含义不同)的数目分别是12万多和13万多，基本平衡。而魔镜杯发布的测试集包含17万多个样本，只给出了q1,q2，需要选手自动输出label。

对于这种比赛，数据保护是主办方要考虑的一个问题，不同的比赛风格不同，比如我[上一篇博客](https://limiao06.github.io/paddle-qiche.html)提到的汽车大师比赛，是利用虚拟化技术，数据放在云端上，无法下载到本地，因此也必须提供云端计算资源。而魔镜杯的方法我感觉非常有特色，那就是先把数据进行“加密”然后再公开，允许选手把数据下载到本地。**下图** 是魔镜杯发布的数据形式，训练集和测试集中的句子并不是以自然语言文本的形式给出的，而是给出了id化的词序列和字序列两种方式，词序列由词id组成，字序列由字id组成，无法直接看懂原句到底是什么。魔镜杯提供了2万个词左右的词典和3千个字左右的字典，并且提供了300维的词向量和300维的字向量。

## 思路
看到这个问题，我产生了两方面的思路，一是规则方法，二是机器学习方法。首先来看规则方法：

### 规则方法

本文所谓规则方法，是指不利用统计学习方法，而仅利用“含义相同”和“含义不同”这两种关系的特点进行推理的方法。

“含义相同” 和 “含义不同” 在本任务中都属于二元关系，可以作用于两个问题实体q1和q2，构成一个三元组(q1, r, q2)，这里指定r1表示“含义相同”，r2表示“含义不同”。下面我们可以讨论下r1和r2的性质。

* r1和r2都有对称性：即 (q1,r1,q2) 可以导出 (q2,r1,q1)，缩写为 (q1,r1,q2) => (q2,r1,q1)； 同样， (q1,r2,q2) => (q2,r2,q1)。 这个很好理解。
* r1有传递性：  (q1,r1,q2) and  (q2,r1,q3) => (q1,r1,q3)，这个也很好理解，如果q1和q2含义相同，q2和q3含义相同，那么q1和q3含义也相同，事实上这时q1,q2,q3构成了一个同义集， 集合中任意两个问句的含义都相同。
* r2有**特殊**的传递性（不知道这个性质较叫什么）： (q1,r1,q2) and  (q2,r2,q3) => (q1,r2,q3)，解释一下，如果q1和q2含义相同，但是q2和q3含义不同，那么q1和q3的含义也就不同，其实也很容易理解。

### 机器学习方法

## 代码

## 心得


> Written with [StackEdit](https://stackedit.io/).
<!--stackedit_data:
eyJoaXN0b3J5IjpbLTE0NDI2NDgxMzAsMTY1MDY1MDMxMywtMj
gzNDUyODM3LC01MjkyMjQ5MzBdfQ==
-->